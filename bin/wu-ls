#!/usr/bin/env ruby
require_relative '../lib/wukong/script/hadoop_runner'

Settings.description = 'list directory contents'
Settings.define :recursive, flag: 'r', description: 'List subdirectories recursively', type: :boolean
Settings.resolve!

cmd = ['fs']
cmd << (Settings.recursive ? '-lsr' : '-ls')
cmd += Settings.rest

Wukong::Script::HadoopRunner.run(cmd)
